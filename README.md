# Resilient-Scatter-Gather

Тестовое задание на позицию Go-разработчика.

## Требования
Нужно написать HTTP-хендлер для API Gateway. Клиент запрашивает «Сводку по чату». Чтобы собрать ответ, нужно одновременно сходить в 3 микросервиса (в проекте симулируются моками/функциями с `time.Sleep`):

1) **UserService (getUser)** — критичный. Отвечает быстро (~10ms). Если упал — **500**.

2) **VectorMemory (getContext)** — тяжёлый, нестабильный. Может отвечать 100ms, может 3 секунды, может упасть. Не критичный (если не ответил/упал — отдаём ответ без него).

3) **PermissionsService (checkAccess)** — критичный. Отвечает ~50ms.

## Задача
Реализовать хендлер, который:
1) Запускает запросы параллельно (fan-out).
2) Имеет жёсткий SLA на ответ клиенту: **200ms**.
3) Degradation: если `VectorMemory` не успел за 200ms — отключаем его, но возвращаем **200 OK** с данными от `User` и `Permissions`.
4) Если критичный сервис (`User` или `Permissions`) упал или не успел — возвращаем **500**.

## Структура проекта
- `cmd/gateway/` — точка входа, запуск HTTP-сервера
- `internal/app/` — сборка зависимостей и регистрация хендлеров
- `internal/handlers/` — HTTP-хендлеры (в т.ч. `/chat/summary`)
- `internal/clients/` — клиенты к микросервисам (интерфейсы/реализации)
- `internal/mocks/` — моки сервисов (sleep/ошибки) для симуляции поведения
- `internal/models/` — модели запросов/ответов (DTO)

## Быстрая проверка сценариев (через query)
- `vm_delay=3s` — VectorMemory не успевает, ответ 200 OK без context
- `vm_fail=1` — VectorMemory падает, ответ 200 OK без context
- `perms_delay=250ms` — критичный сервис не успевает, 500
- `user_fail=1` — критичный сервис падает, 500

## CI
На каждый push/PR запускаются `go test ./...` и `go test -race ./...` (GitHub Actions).

## Запуск
```bash
go run ./cmd/gateway

